@echo off
echo ğŸ¼ Audio Quality Converter Starting...
echo.

REM Create directories
if not exist "input_songs" mkdir input_songs
if not exist "output_songs" mkdir output_songs

REM Check if FFmpeg is available
ffmpeg -version >nul 2>&1
if errorlevel 1 (
    echo âŒ FFmpeg not found!
    echo ğŸ“¥ Please install FFmpeg first:
    echo    Download from https://ffmpeg.org/download.html
    echo    Or use: winget install ffmpeg
    pause
    exit /b 1
)

echo âœ… FFmpeg is ready!
echo.

REM Check if input directory has files
dir /b "input_songs\*.mp3" >nul 2>&1
if errorlevel 1 (
    dir /b "input_songs\*.wav" >nul 2>&1
    if errorlevel 1 (
        echo âŒ No audio files found in input_songs folder!
        echo ğŸ“ Please add your .mp3 or .wav files to the input_songs folder
        pause
        exit /b 1
    )
)

echo ğŸš€ Processing all audio files...
echo.

REM Process each MP3 file
for %%f in ("input_songs\*.mp3") do (
    echo ğŸµ Processing: %%~nf
    
    REM Low quality (64kbps)
    if not exist "output_songs\%%~nf_low.mp3" (
        echo    ğŸ”„ Creating low quality...
        ffmpeg -i "%%f" -b:a 64k -map_metadata 0 "output_songs\%%~nf_low.mp3" -y -loglevel quiet
        echo    âœ… Low quality created
    ) else (
        echo    â­ï¸  Low quality already exists
    )
    
    REM Medium quality (128kbps)
    if not exist "output_songs\%%~nf_medium.mp3" (
        echo    ğŸ”„ Creating medium quality...
        ffmpeg -i "%%f" -b:a 128k -map_metadata 0 "output_songs\%%~nf_medium.mp3" -y -loglevel quiet
        echo    âœ… Medium quality created
    ) else (
        echo    â­ï¸  Medium quality already exists
    )
    
    REM High quality (320kbps)
    if not exist "output_songs\%%~nf_high.mp3" (
        echo    ğŸ”„ Creating high quality...
        ffmpeg -i "%%f" -b:a 320k -map_metadata 0 "output_songs\%%~nf_high.mp3" -y -loglevel quiet
        echo    âœ… High quality created
    ) else (
        echo    â­ï¸  High quality already exists
    )
    
    echo    âœ¨ Finished: %%~nf
    echo.
)

REM Process each WAV file
for %%f in ("input_songs\*.wav") do (
    echo ğŸµ Processing: %%~nf
    
    REM Low quality (64kbps)
    if not exist "output_songs\%%~nf_low.mp3" (
        echo    ğŸ”„ Creating low quality...
        ffmpeg -i "%%f" -b:a 64k -map_metadata 0 "output_songs\%%~nf_low.mp3" -y -loglevel quiet
        echo    âœ… Low quality created
    ) else (
        echo    â­ï¸  Low quality already exists
    )
    
    REM Medium quality (128kbps)
    if not exist "output_songs\%%~nf_medium.mp3" (
        echo    ğŸ”„ Creating medium quality...
        ffmpeg -i "%%f" -b:a 128k -map_metadata 0 "output_songs\%%~nf_medium.mp3" -y -loglevel quiet
        echo    âœ… Medium quality created
    ) else (
        echo    â­ï¸  Medium quality already exists
    )
    
    REM High quality (320kbps)
    if not exist "output_songs\%%~nf_high.mp3" (
        echo    ğŸ”„ Creating high quality...
        ffmpeg -i "%%f" -b:a 320k -map_metadata 0 "output_songs\%%~nf_high.mp3" -y -loglevel quiet
        echo    âœ… High quality created
    ) else (
        echo    â­ï¸  High quality already exists
    )
    
    echo    âœ¨ Finished: %%~nf
    echo.
)

echo ğŸ‰ All done!
echo ğŸ“ Check your converted files in the output_songs folder
echo.
pause